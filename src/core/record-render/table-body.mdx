---
name: Table
route: /Table
menu: Table / 表格渲染
---

import { Playground, PropsTable } from 'docz'
import { ShowModal } from '../modal';
import { Table, DescHelper } from './';
import { DropdownMenu } from '../selector';

# Table

## 通用表格渲染

<PropsTable of={Table} />

## 通用配置

<Playground>
  {
    () => {
      let table;
      const keyMapper = [
        {
          key: 'username',
          tips: [
            '可以是数组1',
            '可以是数组2',
            '可以是数组3',
          ],
          title: (keyMapper) => {
            return (
              <span>使用 func title 返回表头</span>
            )
          },
          namesMapper: {
            alex: '埃里克斯',
            chili: '吃梨',
            dove: '德芙',
          }
        },
        {key: 'age'},
        {key: 'add', labels: {
          cn: 'red'
        }},
        {key: 'birth', date: 1},
        {key: 'obj', filter: (_, item) => {
          return _.account
        }},
        {key: 'status', title: {
          type: 'selector',
          values: {
            normal: '正常',
            abnormal: '异常',
          },
          onChange: (val) => {
            console.log(val);
          }
        }},
        {key: 'action', filter: (str, item) => {
          return (
            <div>
              <span
                onClick={e => ShowModal({
                  children: <DescHelper keyMapper={keyMapper} record={item} />
                })}
                className="link-btn">详情</span>
              <span
                onClick={e => ShowModal({
                  width: 1000,
                  children: (
                    <Table
                      keyMapper={keyMapper}
                      ref={e => table = e}
                      whenCheckAction={(
                        <span className="btn theme mu10" onClick={e => table.clearCheckeds()}>
                          清除所有的以选中项
                        </span>
                      )}
                      needCheck
                      needCount
                      records={records} />
                  )
                })}
                className="link-btn t_red">弹出表格</span>
            </div>
          )
        }}
      ]

      const records = [
        {
          username: 'alex',
          age: '100,100',
          add: 'cn',
          obj: {
            account: 123,
          },
          birth: new Date('1999-01-01'),
        },
        {
          username: 'chili',
          age: '102',
          add: 'cn',
          obj: {
            account: 123,
          },
          birth: new Date('1999-01-01'),
        },
        {
          username: 'dove',
          age: '50',
          add: 'cn1241241241257172590812903890128590127095712905709125u012',
          obj: {
            account: 123,
          },
          birth: new Date('1999-01-01'),
        },
        {
          username: 'susam',
          age: '20',
          add: 'uk',
          obj: {
            account: 123,
          },
          birth: new Date('1999-01-01'),
        },
      ]

      return (
        <Table
          keyMapper={keyMapper}
          ref={e => table = e}
          whenCheckAction={(
            <span className="btn theme mu10" onClick={e => table.clearCheckeds()}>
              清除所有的以选中项
            </span>
          )}
          needCheck
          needCount
          records={records} />
      )
    }
  }
</Playground>

## 在表头添加选择器

> 通过传入不同类型的 title 字段，实现多种表头

### 1. object title

```js
// propsForSelector 会全部传入 DropdownMenu，type 用于标记是什么类型
const keyMapper = {
  key: 'status',
  title: {
    type: 'selector',
    ...propsForSelector
  }
}
```

### 2. function title

```js
// 定义 title 的过滤器，实现返回任意内容
const keyMapper = {
  key: 'any',
  title: () => {
    return (
      <div>
        ...
      </div>
    )
  }
}
```

### 3. string title

```js
// 一般的文字内容
const keyMapper = {
  key: 'title',
  title: '表头'
}
```

## 表格项中的过滤器

### 万能的 filter

可以返回任意想要的字段，在以下内置过滤器中找不到符合预期的，可以通过 filter 返回

```js
const keyMapper = [
  {
    key: '',
    filter: (str, item, mapper, idx) => {
      return (
        // 任意内容
      )
    }
  }
]
```

### labels

内置的 labels 过滤器

```js
const keyMapper = [
  {
    key: '',
    labels: {
      // srcStr 匹配的字符
      // labelColor label 的颜色
      [srcStr]: [labelColor]
    }
  }
]
```

### namesMapper

内置的 字段映射 过滤器

```js
const keyMapper = [
  {
    key: '',
    namesMapper: {
      // srcStr 匹配的字符
      // mapStr 映射的值
      [srcStr]: [mapStr]
    }
  }
]
```

### date || datetime

内置的时间过滤器

```js
const keyMapper = [
  {
    key: '',
    date: boolean, // 格式成 YYYY-MM-DD
    datetime: boolean, // 格式成 YYYY-MM-DD hh:mm:ss
  }
]
```

### money || abvMoney

内置的金钱格式化过滤器

```js
const keyMapper = [
  {
    key: '',
    money: boolean, // 格式成金钱
    abvMoney: boolean, // 格式成金钱绝对值
  }
]
```

## RecordRender 提供的能力

- 渲染远端表格数据
- 数据的具体字段过滤器
- 点击表头做已有数据排序
- 统计所有能统计的数字值
- 带有可选项

```js
const DescHelper = require('./desc-helper').default;
const { ShowModal } = require('../modal');

class ForTable extends React.Component {
  constructor(props) {
    super(props);

    this.keyMapper = [
      {
        key: 'username',
        tips: [
          '可以是数组1',
          '可以是数组2',
          '可以是数组3',
        ],
        title: (keyMapper) => {
          return (
            <span>使用 func title 返回表头</span>
          )
        },
        namesMapper: {
          alex: '埃里克斯',
          chili: '吃梨',
          dove: '德芙',
        }
      },
      {key: 'age'},
      {key: 'add'},
      {key: 'birth', date: 1},
      {key: 'obj', filter: (_, item) => {
        return _.account
      }},
      {key: 'action', filter: (str, item) => {
        return (
          <span
            onClick={e => ShowModal({
              children: <DescHelper keyMapper={this.keyMapper} record={item} />
            })}
            className="link-btn">详情</span>
        )
      }}
    ]

    this.records = [
      {
        username: 'alex',
        age: '100,100',
        add: 'cn',
        obj: {
          account: 123,
        },
        birth: new Date('1999-01-01'),
      },
      {
        username: 'chili',
        age: '102',
        add: 'cn',
        obj: {
          account: 123,
        },
        birth: new Date('1999-01-01'),
      },
      {
        username: 'dove',
        age: '50',
        add: 'cn',
        obj: {
          account: 123,
        },
        birth: new Date('1999-01-01'),
      },
      {
        username: 'susam',
        age: '20',
        add: 'uk',
        obj: {
          account: 123,
        },
        birth: new Date('1999-01-01'),
      },
    ]
  }
  render() {
    return (
      <div>
        <Table
          keyMapper={this.keyMapper}
          ref={e => this.table = e}
          whenCheckAction={(
            <span className="btn theme mu10" onClick={e => this.table.clearCheckeds()}>
              清除所有的以选中项
            </span>
          )}
          needCheck={true}
          needCount={true}
          records={this.records} />
      </div>
    )
  }
}

<ForTable />
```